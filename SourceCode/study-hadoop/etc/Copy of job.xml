<?xml version="1.0" encoding="UTF-8"?>
<conf>
	<sources>
		<file name="HDP_TX_O_F_DSDSA" >																				
			<path>hdfs://200master:9000/user/root/zxyh/HDP_TX_O_F_DSDSA.txt</path>
			<compressed>gzip</compressed>
			<where>DSACNO>100</where>
		</file> 
		<table name="HDP_CM_O_F_PMTPA" >
			<where>DSACNO>100</where>
		</table>   
		<table name="HDP_TX_O_F_TRANSLIST" > 											
			<where>DSACNO>100</where>
		</table>
		<file name="HDP_TX_O_F_DSDSA&HDP_CM_O_F_PMTPA"> 
			<path>hdfs://200master:9000/user/root/zxyh/tmp/HDP_TX_O_F_DSDSA&HDP_CM_O_F_PMTPA</path>
		</file>
		<file name="HDP_TX_O_F_DSDSA&HDP_CM_O_F_PMTPA&HDP_TX_O_F_TRANSLIST"> 
			<path>hdfs://200master:9000/user/root/zxyh/tmp/HDP_TX_O_F_DSDSA&HDP_CM_O_F_PMTPA&HDP_TX_O_F_TRANSLIST</path>
		</file>
		<table name="HDP_TX_O_F_DSDSA_T">	<!-- 储蓄活期明细表 -->
			<field name="DSACNO"/>		<!-- 账号 -->
			<field name="DSNFFG"/>		<!-- 非金融标识 -->
			<field name="DSTRDT"/>		<!-- 交易日期 -->
			<field name="DSTRTM"/>		<!-- 交易时间 -->
			<field name="DSTRCD"/>		<!-- 交易码 -->
			<field name="DSTRNO"/>		<!-- 柜员交易号 -->
			
			<field name="TPTACD"/>		<!-- 交易摘要码 -->
			<field name="TPPMTX"/>		<!-- 参数说明 -->
			
			<field name="FLOW_ID"/>		<!-- 工作流任务号 -->   
		</table>
	</sources>
	
	<tasks clear="false"> 		
		<join>
			<leftSource>HDP_TX_O_F_DSDSA</leftSource>
			<rightSource>HDP_CM_O_F_PMTPA</rightSource>
			<leftField>DSTRCD</leftField>
			<rightField>TPTRCD</rightField>
			<reservedField>DSTRCD</reservedField>
			<mapperExtension>com.citic.zxyjs.zwlscx.mapreduce.lib.extension.test.MapperExtension</mapperExtension>
			<reducerExtension>com.citic.zxyjs.zwlscx.mapreduce.lib.extension.test.ReducerExtension</reducerExtension>
			<jobExtension>com.citic.zxyjs.zwlscx.mapreduce.lib.extension.test.JobExtension</jobExtension>
			<output>HDP_TX_O_F_DSDSA-HDP_CM_O_F_PMTPA</output>
			<errorOutput>hdfs://200master:9000/user/root/zxyh/error/HDP_TX_O_F_DSDSA-HDP_CM_O_F_PMTPA-HDP_TX_O_F_DSDSA</errorOutput>
		</join>
		<join>
			<leftSource>HDP_TX_O_F_DSDSA-HDP_CM_O_F_PMTPA</leftSource>
			<rightSource>HDP_TX_O_F_TRANSLIST</rightSource>
			<leftField>DSTRNO</leftField>
			<rightField>DSACNO</rightField>
			<reservedField>DSTRNO</reservedField>
			<output>HDP_TX_O_F_DSDSA-HDP_CM_O_F_PMTPA-HDP_TX_O_F_TRANSLIST</output>
			<errorOutput>hdfs://200master:9000/user/root/zxyh/error/HDP_TX_O_F_DSDSA-HDP_CM_O_F_PMTPA-HDP_TX_O_F_TRANSLIST-HDP_TX_O_F_DSDSA</errorOutput>
		</join>
		<append>
			<leftSource>HDP_TX_O_F_DSDSA-HDP_CM_O_F_PMTPA-HDP_TX_O_F_TRANSLIST</leftSource>
			<rightSource>HDP_TX_O_F_DSDSA_T</rightSource>
			<output>hdfs://200master:9000/user/root/zxyh/tmp/hfile</output>
		</append>    
	</tasks>
</conf>